/**
 * @author Aaron Clinger - https://github.com/aaronclinger/videoevents.js
 */
!function(e){"use strict";function n(e,n,t){var r={before:!0},a,u,c,i;return r.getType=function(){return c},r.getValue=function(){return u},r.getCallback=function(){return a},r.isOnce=function(){return i},r.trigger=function(e,n,t,r){var i={sender:e,type:c,time:n,percent:t,duration:r};switch(c){case"percent":case"time":i.value=u;break}a(i)},r.equals=function(e,n){var t=u===e.getValue()&&c===e.getType();return t&&n&&(t=a===e.getCallback()),t},function(e,n,t){return c=e.type,u=e.value,a=n,i=!!t,r}(e,n,t)}function t(e){var t={},a=[],u=null,c,i;t.on=function(e,n){return s(e,n,!1),t},t.once=function(e,n){return s(e,n,!0),t},t.off=function(e,u){var c=a.length,i,o,s;if(e){if(!1!==(o=r(e)))for(s=new n(o,u),i=!!u;c--&&(!a[c].equals(s,i)||(a.splice(c,1),!i)););}else a=[];return t},t.getPlayer=function(){return i},t.destroy=function(){i&&(c?(i.removeEventListener("onReady",l),i.removeEventListener("onStateChange",p),null!==u&&(clearInterval(u),u=null)):(i.off("play",g),i.off("pause",v),i.off("ended",y),i.off("timeupdate",b)),a=[],i=null)};var o=function(e){i=e,c=!!i.addEventListener,c?i.addEventListener("onReady",l):(i.on("play",g),i.on("pause",v),i.on("ended",y),i.on("timeupdate",b))},s=function(e,t,u){var c=r(e),i,o;if(!1!==c){for(i=new n(c,t,u),o=a.length;o--;)if(a[o].equals(i,!0))return;a.push(i)}},f=function(e,n,r,u){for(var c=-1,i,o,s,f;++c<a.length;){if(s=a[c],i=!1,e===s.getType())switch(e){case"play":case"pause":case"end":case"progress":i=!0;break}else if("progress"===e)switch(s.getType()){case"time":case"percent":f=s.getValue(),"time"===s.getType()?(o=n,f<0&&(f=Math.max(0,u+f))):o=r,f>o?s.before=!0:s.before&&f<=o&&(s.before=!1,i=!0);break}i&&(s.trigger(t,n,r,u),s.isOnce()&&a.splice(c--,1))}},l=function(){i.addEventListener("onStateChange",p)},p=function(e){switch(e.data){case 0:d("end");break;case 1:d("play");break;case 2:d("pause");break}},d=function(e){var n=i.getCurrentTime(),t=i.getDuration(),r=Math.min(1,Math.max(0,n/t));switch(e){case"play":null===u&&(u=setInterval(function(){d("progress")},250));break;case"pause":case"end":clearInterval(u),u=null;break}f(e,n,r,t)},g=function(e){h("play",e)},v=function(e){h("pause",e)},y=function(e){h("end",e)},b=function(e){h("progress",e)},h=function(e,n){f(e,n.seconds,n.percent,n.duration)};return o(e),t}var r=function(e){if(e===""+e)switch(e=e.toLowerCase()){case"play":case"pause":case"end":case"progress":return{type:e,value:null};default:if("%"===e.slice(-1)&&!1!==(e=a(e.slice(0,-1)))&&e>=0&&e<=100)return{type:"percent",value:e/100}}return!1!==(e=a(e))&&{type:"time",value:e}},a=function(e){return(e=Number(e))+0===e&&e};e.VideoEvents=t}(window);